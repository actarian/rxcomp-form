{"version":3,"sources":["docs/js/main.js","../../src/form/form-accessor.js","../../src/form.module.js","../../src/form/form-status.js","../../src/form/form-abstract.js","../../src/form/form-control.js","../../src/form/form-group.js","../../src/form/form-abstract-collection.js","../../src/form/form-validators.js","../../test/js/app.component.js","../../test/js/app.module.js","../../test/js/main.js"],"names":["global","factory","exports","module","require","define","amd","self","rxcomp","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_inheritsLoose","subClass","superClass","create","constructor","__proto__","AccessorProps","FormAccessor","_Component","apply","arguments","_proto","onInit","node","getContext","onChange","bind","onBlur","addEventListener","onChanges","changes","_this","getAttributeNode","value","control","formGroup","get","value$","pipe","takeUntil","unsubscribe$","subscribe","console","log","status$","status","pre","getPre","textContent","forEach","x","classList","add","remove","errors","writeValue","setAttribute","setDisabledState","disabled","previousSibling","nodeType","document","createTextNode","parentNode","insertBefore","event","onFocus","touched","Component","meta","selector","inputs","FormModule","_Module","Module","factories","pipes","declarations","concat","FormStatus","FormAbstract","validators","initSubjects_","valueSubject","BehaviorSubject","valueChildren","Subject","statusSubject","statusChildren","initObservables_","merge","distinctUntilChanged","skip","tap","dirty_","next","shareReplay","reduceValidators_","validate","map","filter","touched_","set","value_","FormControl","_FormAbstract","call","ReferenceError","_assertThisInitialized","FormGroup","_FormAbstractCollecti","controls","forEach_","callback","keys","FormAbstractCollection","initControls_","initControl_","_this2","_this3","reduce_","result","push","combineLatest","latest","_this4","all_","any_","RequiredValidator","AppComponent","group","firstName","lastName","values","valid","AppModule","imports","CoreModule","bootstrap","Browser"],"mappings":"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","file":"docs/js/main.min.js","sourcesContent":[null,"import { Component, getContext } from 'rxcomp';\nimport { takeUntil } from 'rxjs/operators';\n\nconst AccessorProps = ['untouched', 'touched', 'pristine', 'dirty', 'pending', 'enabled', 'disabled', 'valid', 'invalid'];\n\n// recall Directive\nexport default class FormAccessor extends Component {\n\n\tonInit() {\n\t\t// context\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\tthis.node = node;\n\t\t// log(node.getAttributeNode('formControl').value);\n\t\t// log('name', node.name);\n\t\tthis.onChange = this.onChange.bind(this);\n\t\tthis.onBlur = this.onBlur.bind(this);\n\t\t// this.onFocus = this.onFocus.bind(this);\n\t\tnode.addEventListener('input', this.onChange);\n\t\tnode.addEventListener('change', this.onChange);\n\t\tnode.addEventListener('blur', this.onBlur);\n\t\t// node.addEventListener('focus', this.onFocus);\n\t}\n\n\tonChanges(changes) {\n\t\t// console.log('FormAccessor.onChanges', changes);\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\t// const key = node.getAttributeNode('formControl').value;\n\t\tconst key = node.getAttributeNode('[name]').value;\n\t\t// console.log(key, this.formGroup);\n\t\tconst control = this.formGroup.get(key);\n\t\t// const control = group.controls[key]; // FORM[key];\n\t\tcontrol.value$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(value => {\n\t\t\tconsole.log('Accessor.control.valueChanges$', value);\n\t\t});\n\t\tcontrol.status$.pipe(\n\t\t\ttakeUntil(this.unsubscribe$)\n\t\t).subscribe(status => {\n\t\t\tconst pre = this.getPre(node);\n\t\t\tpre.textContent = '';\n\t\t\tAccessorProps.forEach(x => {\n\t\t\t\tif (control[x]) {\n\t\t\t\t\tnode.classList.add(x);\n\t\t\t\t\tpre.textContent += x + ', ';\n\t\t\t\t} else {\n\t\t\t\t\tnode.classList.remove(x);\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontrol.errors.forEach(x => pre.textContent += `invalid-${x}, `);\n\t\t});\n\t\tthis.writeValue(control.value);\n\t\t// node.value = 'test';\n\t}\n\n\twriteValue(value) {\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\tnode.setAttribute('value', value == null ? '' : value);\n\t}\n\n\tsetDisabledState(disabled) {\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\tnode.setAttribute('disabled', disabled);\n\t}\n\n\tgetPre(node) {\n\t\tlet pre = node.previousSibling;\n\t\tif (!pre || pre.nodeType !== 3) {\n\t\t\tpre = document.createTextNode('');\n\t\t\tnode.parentNode.insertBefore(pre, node);\n\t\t}\n\t\treturn pre;\n\t}\n\n\tonChange(event) {\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\t// const key = node.getAttributeNode('formControl').value;\n\t\tconst key = node.getAttributeNode('[name]').value;\n\t\tconst control = this.formGroup.get(key);\n\t\t// const control = group.controls[key]; // FORM[key];\n\t\t// event.currentTarget;\n\t\t// log(event.type, node.name, node.value, node.checked);\n\t\t// log('control', key, control.value);\n\t\tcontrol.value = node.value;\n\t}\n\n\tonFocus(event) {}\n\n\tonBlur(event) {\n\t\t// log(event.type);\n\t\tconst context = getContext(this);\n\t\tconst node = context.node;\n\t\t// const key = node.getAttributeNode('formControl').value;\n\t\tconst key = node.getAttributeNode('[name]').value;\n\t\tconst control = this.formGroup.get(key);\n\t\t// const control = group.controls[key]; // FORM[key];\n\t\tcontrol.touched = true;\n\t}\n}\n\nFormAccessor.meta = {\n\tselector: 'input,textarea,select',\n\tinputs: ['formGroup'],\n};\n","import { Module } from 'rxcomp';\nimport FormAccessor from './form/form-accessor';\n\nexport default class FormModule extends Module {}\nconst factories = [\n\tFormAccessor\n];\nconst pipes = [\n];\nFormModule.meta = {\n\tdeclarations: [\n\t\t...factories,\n\t\t...pipes,\n\t],\n\texports: [\n\t\t...factories,\n\t\t...pipes,\n\t]\n};\n","const FormStatus = {\n\tValid: 'valid',\n\tInvalid: 'invalid',\n\tPending: 'pending',\n\tDisabled: 'disabled',\n};\n\nexport default FormStatus;\n","import { BehaviorSubject, merge, Subject } from \"rxjs\";\nimport { distinctUntilChanged, shareReplay, skip, tap } from 'rxjs/operators';\nimport FormStatus from './form-status';\n\nexport default class FormAbstract {\n\tconstructor(validators = []) {\n\t\tthis.validators = validators;\n\t\t// this.errors = {};\n\t\tthis.errors = [];\n\t}\n\n\tinitSubjects_() {\n\t\tthis.valueSubject = new BehaviorSubject(null);\n\t\tthis.valueChildren = new Subject();\n\t\tthis.statusSubject = new BehaviorSubject(this);\n\t\tthis.statusChildren = new Subject();\n\t}\n\n\tinitObservables_() {\n\t\tthis.value$ = merge(this.valueSubject, this.valueChildren).pipe(\n\t\t\tdistinctUntilChanged(),\n\t\t\tskip(1),\n\t\t\ttap(value => {\n\t\t\t\tthis.dirty_ = true;\n\t\t\t\tif (value === this.value) {\n\t\t\t\t\tthis.statusSubject.next(this);\n\t\t\t\t}\n\t\t\t}),\n\t\t\tshareReplay(1)\n\t\t);\n\t\tthis.status$ = merge(this.statusSubject, this.statusChildren).pipe(\n\t\t\t// auditTime(1),\n\t\t\ttap(status => {\n\t\t\t\tthis.reduceValidators_();\n\t\t\t}),\n\t\t\tshareReplay(1)\n\t\t);\n\t}\n\n\treduceValidators_() {\n\t\treturn [];\n\t}\n\n\tvalidate(value) {\n\t\tif (this.status === FormStatus.Disabled) {\n\t\t\t// this.errors = {};\n\t\t\tthis.errors = [];\n\t\t} else {\n\t\t\t// this.errors = Object.assign({}, ...this.validators.map(x => x(value)));\n\t\t\t// this.status = Object.keys(this.errors).length === 0 ? FormStatus.Valid : FormStatus.Invalid;\n\t\t\tthis.errors = this.validators.map(x => x(value)).filter(x => x !== null);\n\t\t\tthis.status = this.errors.length === 0 ? FormStatus.Valid : FormStatus.Invalid;\n\t\t}\n\t\treturn this.errors;\n\t}\n\n\tget valid() { return this.status === FormStatus.Valid; }\n\tget invalid() { return this.status === FormStatus.Invalid; }\n\tget pending() { return this.status === FormStatus.Pending; }\n\tget disabled() { return this.status === FormStatus.Disabled; }\n\tget enabled() { return this.status !== FormStatus.Disabled; }\n\tget dirty() { return this.dirty_; }\n\tget pristine() { return !this.dirty_; }\n\tget touched() { return this.touched_; }\n\tget untouched() { return !this.touched_; }\n\n\tset touched(touched) {\n\t\tthis.touched_ = touched;\n\t\tthis.statusSubject.next(this);\n\t}\n\n\tget value() { return this.value_; }\n\n\tset value(value) {\n\t\tthis.value_ = value;\n\t\tthis.valueSubject.next(value);\n\t}\n\n}\n","import FormAbstract from \"./form-abstract\";\n\nexport default class FormControl extends FormAbstract {\n\n\tconstructor(value = null, validators) {\n\t\tsuper(validators);\n\t\tthis.value_ = value;\n\t\tthis.initSubjects_();\n\t\tthis.initObservables_();\n\t\tthis.statusSubject.next(this);\n\t}\n\n\treduceValidators_() {\n\t\treturn this.validate(this.value);\n\t}\n\n}\n\nexport function formControl(value, validators) {\n\treturn new FormControl(value, validators);\n}\n","import FormAbstractCollection from './form-abstract-collection';\n\nexport default class FormGroup extends FormAbstractCollection {\n\n\tconstructor(controls = {}, validators) {\n\t\tsuper(controls, validators);\n\t}\n\n\tforEach_(callback) {\n\t\tObject.keys(this.controls).forEach(key => callback(this.controls[key], key));\n\t}\n\n\tget(key) {\n\t\treturn this.controls[key];\n\t}\n\n\tset(control, key) {\n\t\tthis.controls[key] = control;\n\t}\n\n}\n\nexport function formGroup(controls, validators) {\n\treturn new FormGroup(controls, validators);\n}\n","import { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map, shareReplay } from 'rxjs/operators';\nimport FormAbstract from './form-abstract';\nimport FormControl from './form-control';\nimport FormStatus from './form-status';\n\nexport default class FormAbstractCollection extends FormAbstract {\n\n\tconstructor(controls, validators) {\n\t\tsuper(validators);\n\t\tthis.controls = controls;\n\t\tthis.initControls_(controls);\n\t\tthis.initSubjects_();\n\t\tthis.initObservables_();\n\t\t// this.statusSubject.next(this);\n\t}\n\n\tinitControl_(control) {\n\t\treturn control instanceof FormAbstract ? control : new FormControl(control, this.validators);\n\t}\n\n\tinitControls_(controls) {\n\t\tthis.forEach_((control, key) => {\n\t\t\tthis.set(this.initControl_(control), key);\n\t\t});\n\t\treturn controls;\n\t}\n\n\tinitSubjects_() {\n\t\tthis.valueSubject = new BehaviorSubject(null);\n\t\tconst valueChildren = this.reduce_((result, control) => {\n\t\t\tresult.push(control.valueSubject);\n\t\t\treturn result;\n\t\t}, []);\n\t\tthis.valueChildren = combineLatest(valueChildren).pipe(\n\t\t\tmap(latest => this.value),\n\t\t\t// distinctUntilChanged((a, b) => JSON.stringify(a) === JSON.stringify(b)),\n\t\t\t// this.dirty_ = this.any_('dirty_', true);\n\t\t\t/*\n\t\t\tmap(merged => {\n\t\t\t\tconst values = {};\n\t\t\t\tObject.keys(this.controls).forEach((key, i) => {\n\t\t\t\t\tvalues[key] = merged[i] || null;\n\t\t\t\t});\n\t\t\t\treturn values;\n\t\t\t}),\n\t\t\ttap(value => {\n\t\t\t\tthis.dirty_ = true;\n\t\t\t\tthis.statusSubject.next(this);\n\t\t\t}),\n\t\t\t*/\n\t\t\tshareReplay(1)\n\t\t);\n\t\tthis.statusSubject = new BehaviorSubject(this);\n\t\tconst statusChildren = this.reduce_((result, control) => {\n\t\t\tresult.push(control.status$);\n\t\t\treturn result;\n\t\t}, []);\n\t\tthis.statusChildren = combineLatest(statusChildren).pipe(\n\t\t\t/*\n\t\t\ttap(controls => {\n\t\t\t\tthis.dirty_ = this.any_('dirty_', true);\n\t\t\t}),\n\t\t\t*/\n\t\t\tshareReplay(1)\n\t\t);\n\t}\n\n\tvalidate(value) {\n\t\tif (this.status === FormStatus.Disabled) {\n\t\t\t// this.errors = {};\n\t\t\tthis.errors = [];\n\t\t} else {\n\t\t\t// this.errors = Object.assign({}, ...this.validators.map(x => x(value)));\n\t\t\t// this.status = Object.keys(this.errors).length === 0 ? FormStatus.Valid : FormStatus.Invalid;\n\t\t\tlet errors = this.validators.map(x => x(value)).filter(x => x !== null);\n\t\t\terrors = this.reduce_((result, control) => {\n\t\t\t\treturn result.concat(control.errors);\n\t\t\t}, errors);\n\t\t\tthis.status = this.errors.length === 0 ? FormStatus.Valid : FormStatus.Invalid;\n\t\t}\n\t\treturn this.errors;\n\t}\n\n\tforEach_(callback) {\n\t\tObject.keys(this.controls).forEach(key => callback(this.controls[key], key));\n\t}\n\n\treduce_(callback, result) {\n\t\tthis.forEach_((control, key) => {\n\t\t\tresult = callback(result, control, key);\n\t\t});\n\t\treturn result;\n\t}\n\n\tall_(key, value) {\n\t\treturn this.reduce_((result, control) => {\n\t\t\treturn result && control[key] === value;\n\t\t}, true);\n\t}\n\n\tany_(key, value) {\n\t\treturn this.reduce_((result, control) => {\n\t\t\treturn result || control[key] === value;\n\t\t}, false);\n\t}\n\n\tget(key) {\n\t\treturn this.controls[key];\n\t}\n\n\tset(control, key) {\n\t\tthis.controls[key] = control;\n\t}\n\n\tget touched() {\n\t\treturn this.reduce_((result, control) => {\n\t\t\treturn result && control.touched;\n\t\t}, true);\n\t}\n\n\tset touched(touched) {\n\t\t// this.touched_ = touched;\n\t\tthis.forEach_(control => {\n\t\t\tcontrol.touched = touched;\n\t\t});\n\t\tthis.statusSubject.next(this);\n\t}\n\n\tget value() {\n\t\treturn this.reduce_((result, control, key) => {\n\t\t\tresult[key] = control.value;\n\t\t\treturn result;\n\t\t}, {});\n\t}\n\n\tset value(value) {}\n\n}\n","export function RequiredValidator(value) {\n\t// return (value == null || value.length === 0) ? { required: true } : null;\n\treturn (value == null || value.length === 0) ? 'required' : null;\n}\n","import { Component } from 'rxcomp';\nimport { FormGroup, RequiredValidator } from '../../src/rxcomp-form';\n\nexport default class AppComponent extends Component {\n\n\tonInit() {\n\t\tconst group = this.group = new FormGroup({\n\t\t\tfirstName: 'Jhon',\n\t\t\tlastName: 'Appleseed',\n\t\t}, [RequiredValidator]);\n\n\t\tgroup.value$.subscribe(values => {\n\t\t\tconsole.log('AppComponent.group.value$', values);\n\t\t});\n\n\t\tgroup.status$.subscribe(() => {\n\t\t\t// console.log('AppComponent.group.status$');\n\t\t\tconsole.log('AppComponent.group.valid', group.valid);\n\t\t});\n\t}\n\n}\n\nAppComponent.meta = {\n\tselector: '[app-component]',\n};\n","import { CoreModule, Module } from 'rxcomp';\nimport { FormModule } from '../../src/rxcomp-form';\nimport AppComponent from './app.component';\n\nexport default class AppModule extends Module {}\n\nAppModule.meta = {\n\timports: [\n\t\tCoreModule,\n\t\tFormModule\n\t],\n\tdeclarations: [\n\t],\n\tbootstrap: AppComponent,\n};\n","import { Browser } from 'rxcomp';\nimport AppModule from './app.module';\n\nBrowser.bootstrap(AppModule);\n"]}