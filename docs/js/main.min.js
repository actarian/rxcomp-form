/**
 * @license todomvc v1.0.0-alpha.5
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("main",["rxcomp","rxjs","rxjs/operators"],e):e((t=t||self).rxcomp,t.rxjs,t.rxjs.operators)}(this,(function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var s="valid",o="invalid",a="pending",c="disabled",h=function(){function t(t){void 0===t&&(t=[]),this.validators=t,this.errors=[]}var i=t.prototype;return i.initSubjects=function(){this.value$=new e.BehaviorSubject(null),this.status$=new e.BehaviorSubject(this),this.childrenValue$=new e.Subject,this.childrenStatus$=new e.Subject},i.initObservables=function(){var t=this;this.valueChanges$=e.merge(this.value$,this.childrenValue$).pipe(n.distinctUntilChanged(),n.skip(1),n.tap((function(e){t.dirty_=!0,e===t.value&&t.status$.next(t)})),n.shareReplay(1)),this.statusChanges$=e.merge(this.status$,this.childrenStatus$).pipe(n.tap((function(e){t.reduceValidators()})),n.shareReplay(1))},i.reduceValidators=function(){return[]},i.validate=function(t){return this.status===c?this.errors=[]:(this.errors=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t})),this.status=0===this.errors.length?s:o),this.errors},r(t,[{key:"valid",get:function(){return this.status===s}},{key:"invalid",get:function(){return this.status===o}},{key:"pending",get:function(){return this.status===a}},{key:"disabled",get:function(){return this.status===c}},{key:"enabled",get:function(){return this.status!==c}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(t){this.touched_=t,this.status$.next(this)}},{key:"untouched",get:function(){return!this.touched_}},{key:"value",get:function(){return this.value_},set:function(t){this.value_=t,this.value$.next(t)}}]),t}(),l=function(t){function e(e,n){var i;return void 0===e&&(e=null),(i=t.call(this,n)||this).value_=e,i.initSubjects(),i.initObservables(),i.status$.next(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}return u(e,t),e.prototype.reduceValidators=function(){return this.validate(this.value)},e}(h),d=function(t){function i(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,n)||this).controls=i.asControls(e),i.initSubjects(),i.initObservables(),i}u(i,t);var a=i.prototype;return a.initSubjects=function(){var t=this;this.value$=new e.BehaviorSubject(null),this.status$=new e.BehaviorSubject(this);var i=this.reduce_((function(t,e){return t.push(e.value$),t}),[]);this.childrenValue$=e.combineLatest(i).pipe(n.map((function(e){return t.value})),n.shareReplay(1));var r=this.reduce_((function(t,e){return t.push(e.statusChanges$),t}),[]);this.childrenStatus$=e.combineLatest(r).pipe(n.shareReplay(1))},a.validate=function(t){if(this.status===c)this.errors=[];else{var e=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t}));e=this.reduce_((function(t,e){return t.concat(e.errors)}),e),this.status=0===this.errors.length?s:o}return this.errors},a.asControl=function(t){return t instanceof h?t:new l(t,this.validators)},a.asControls=function(t){var e=this;return void 0===t&&(t={}),Object.keys(t).forEach((function(n){t[n]=e.asControl(t[n])})),t},a.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},a.reduce_=function(t,e){return this.forEach_((function(n,i){e=t(e,n,i)})),e},a.all_=function(t,e){return this.reduce_((function(e,n){return e&&n[t]===e}),!0)},a.any_=function(t,e){return this.reduce_((function(e,n){return e||n[t]===e}),!1)},a.get=function(t){return this.controls[t]},r(i,[{key:"touched",get:function(){return this.reduce_((function(t,e){return t&&e.touched}),!0)},set:function(t){this.forEach_((function(e){e.touched=t})),this.status$.next(this)}},{key:"value",get:function(){return this.reduce_((function(t,e,n){return t[n]=e.value,t}),{})},set:function(t){}}]),i}(h);function f(t){return null==t||0===t.length?"required":null}var p=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e.prototype.onInit=function(){var t=this.group=new d({firstName:"Jhon",lastName:"Appleseed"},[f]);t.valueChanges$.subscribe((function(t){console.log("AppComponent.group.valueChanges$",t)})),t.statusChanges$.subscribe((function(){console.log("AppComponent.group.valid",t.valid)}))},e}(t.Component);p.meta={selector:"[app-component]"};var v=["untouched","touched","pristine","dirty","pending","enabled","disabled","valid","invalid"],g=function(e){function i(){return e.apply(this,arguments)||this}u(i,e);var r=i.prototype;return r.onInit=function(){var e=t.Module.getContext(this).node;this.node=e,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),e.addEventListener("input",this.onChange),e.addEventListener("change",this.onChange),e.addEventListener("blur",this.onBlur)},r.onChanges=function(e){var i=this,r=t.Module.getContext(this).node,u=r.getAttributeNode("[name]").value,s=this.formGroup.get(u);s.valueChanges$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){console.log("Accessor.control.valueChanges$",t)})),s.statusChanges$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){var e=i.getPre(r);e.textContent="",v.forEach((function(t){s[t]?(r.classList.add(t),e.textContent+=t+", "):r.classList.remove(t)})),s.errors.forEach((function(t){return e.textContent+="invalid-"+t+", "}))})),this.writeValue(s.value)},r.writeValue=function(e){t.Module.getContext(this).node.setAttribute("value",null==e?"":e)},r.setDisabledState=function(e){t.Module.getContext(this).node.setAttribute("disabled",e)},r.getPre=function(t){var e=t.previousSibling;return e&&3===e.nodeType||(e=document.createTextNode(""),t.parentNode.insertBefore(e,t)),e},r.onChange=function(e){var n=t.Module.getContext(this).node,i=n.getAttributeNode("[name]").value;this.formGroup.get(i).value=n.value},r.onFocus=function(t){},r.onBlur=function(e){var n=t.Module.getContext(this).node.getAttributeNode("[name]").value;this.formGroup.get(n).touched=!0},i}(t.Component);g.meta={selector:"input,textarea,select",inputs:["formGroup"]},t.Module.use({factories:[t.ClassDirective,t.EventDirective,t.ForStructure,t.IfStructure,t.InnerHtmlDirective,t.StyleDirective,g],pipes:[t.JsonPipe],bootstrap:p})}));
//# sourceMappingURL=main.min.js.map