/**
 * @license todomvc v1.0.0-alpha.5
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("main",["rxcomp","rxjs","rxjs/operators"],e):e((t=t||self).rxcomp,t.rxjs,t.rxjs.operators)}(this,(function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var o="valid",s="invalid",a="pending",c="disabled",h=function(){function t(t){void 0===t&&(t=[]),this.validators=t,this.errors=[]}var i=t.prototype;return i.initSubjects_=function(){this.valueSubject=new e.BehaviorSubject(null),this.valueChildren=new e.Subject,this.statusSubject=new e.BehaviorSubject(this),this.statusChildren=new e.Subject},i.initObservables_=function(){var t=this;this.value$=e.merge(this.valueSubject,this.valueChildren).pipe(n.distinctUntilChanged(),n.skip(1),n.tap((function(e){t.dirty_=!0,e===t.value&&t.statusSubject.next(t)})),n.shareReplay(1)),this.status$=e.merge(this.statusSubject,this.statusChildren).pipe(n.tap((function(e){t.reduceValidators_()})),n.shareReplay(1))},i.reduceValidators_=function(){return[]},i.validate=function(t){return this.status===c?this.errors=[]:(this.errors=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t})),this.status=0===this.errors.length?o:s),this.errors},r(t,[{key:"valid",get:function(){return this.status===o}},{key:"invalid",get:function(){return this.status===s}},{key:"pending",get:function(){return this.status===a}},{key:"disabled",get:function(){return this.status===c}},{key:"enabled",get:function(){return this.status!==c}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(t){this.touched_=t,this.statusSubject.next(this)}},{key:"untouched",get:function(){return!this.touched_}},{key:"value",get:function(){return this.value_},set:function(t){this.value_=t,this.valueSubject.next(t)}}]),t}(),l=function(t){function e(e,n){var i;return void 0===e&&(e=null),(i=t.call(this,n)||this).value_=e,i.initSubjects_(),i.initObservables_(),i.statusSubject.next(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}return u(e,t),e.prototype.reduceValidators_=function(){return this.validate(this.value)},e}(h),f=function(t){function e(e,n){return void 0===e&&(e={}),t.call(this,e,n)||this}u(e,t);var n=e.prototype;return n.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},n.get=function(t){return this.controls[t]},n.set=function(t,e){this.controls[e]=t},e}(function(t){function i(e,n){var i;return(i=t.call(this,n)||this).controls=e,i.initControls_(e),i.initSubjects_(),i.initObservables_(),i}u(i,t);var a=i.prototype;return a.initControl_=function(t){return t instanceof h?t:new l(t,this.validators)},a.initControls_=function(t){var e=this;return this.forEach_((function(t,n){e.set(e.initControl_(t),n)})),t},a.initSubjects_=function(){var t=this;this.valueSubject=new e.BehaviorSubject(null);var i=this.reduce_((function(t,e){return t.push(e.valueSubject),t}),[]);this.valueChildren=e.combineLatest(i).pipe(n.map((function(e){return t.value})),n.shareReplay(1)),this.statusSubject=new e.BehaviorSubject(this);var r=this.reduce_((function(t,e){return t.push(e.status$),t}),[]);this.statusChildren=e.combineLatest(r).pipe(n.shareReplay(1))},a.validate=function(t){if(this.status===c)this.errors=[];else{var e=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t}));e=this.reduce_((function(t,e){return t.concat(e.errors)}),e),this.status=0===this.errors.length?o:s}return this.errors},a.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},a.reduce_=function(t,e){return this.forEach_((function(n,i){e=t(e,n,i)})),e},a.all_=function(t,e){return this.reduce_((function(n,i){return n&&i[t]===e}),!0)},a.any_=function(t,e){return this.reduce_((function(n,i){return n||i[t]===e}),!1)},a.get=function(t){return this.controls[t]},a.set=function(t,e){this.controls[e]=t},r(i,[{key:"touched",get:function(){return this.reduce_((function(t,e){return t&&e.touched}),!0)},set:function(t){this.forEach_((function(e){e.touched=t})),this.statusSubject.next(this)}},{key:"value",get:function(){return this.reduce_((function(t,e,n){return t[n]=e.value,t}),{})},set:function(t){}}]),i}(h));function d(t){return null==t||0===t.length?"required":null}var p=function(t){function e(){return t.apply(this,arguments)||this}return u(e,t),e.prototype.onInit=function(){var t=this.group=new f({firstName:"Jhon",lastName:"Appleseed"},[d]);t.value$.subscribe((function(t){console.log("AppComponent.group.value$",t)})),t.status$.subscribe((function(){console.log("AppComponent.group.valid",t.valid)}))},e}(t.Component);p.meta={selector:"[app-component]"};var v=["untouched","touched","pristine","dirty","pending","enabled","disabled","valid","invalid"],b=function(e){function i(){return e.apply(this,arguments)||this}u(i,e);var r=i.prototype;return r.onInit=function(){var e=t.Module.getContext(this).node;this.node=e,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),e.addEventListener("input",this.onChange),e.addEventListener("change",this.onChange),e.addEventListener("blur",this.onBlur)},r.onChanges=function(e){var i=this,r=t.Module.getContext(this).node,u=r.getAttributeNode("[name]").value,o=this.formGroup.get(u);o.value$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){console.log("Accessor.control.valueChanges$",t)})),o.status$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){var e=i.getPre(r);e.textContent="",v.forEach((function(t){o[t]?(r.classList.add(t),e.textContent+=t+", "):r.classList.remove(t)})),o.errors.forEach((function(t){return e.textContent+="invalid-"+t+", "}))})),this.writeValue(o.value)},r.writeValue=function(e){t.Module.getContext(this).node.setAttribute("value",null==e?"":e)},r.setDisabledState=function(e){t.Module.getContext(this).node.setAttribute("disabled",e)},r.getPre=function(t){var e=t.previousSibling;return e&&3===e.nodeType||(e=document.createTextNode(""),t.parentNode.insertBefore(e,t)),e},r.onChange=function(e){var n=t.Module.getContext(this).node,i=n.getAttributeNode("[name]").value;this.formGroup.get(i).value=n.value},r.onFocus=function(t){},r.onBlur=function(e){var n=t.Module.getContext(this).node.getAttributeNode("[name]").value;this.formGroup.get(n).touched=!0},i}(t.Component);b.meta={selector:"input,textarea,select",inputs:["formGroup"]},t.Module.use({factories:[t.ClassDirective,t.EventDirective,t.ForStructure,t.IfStructure,t.InnerHtmlDirective,t.StyleDirective,b],pipes:[t.JsonPipe],bootstrap:p})}));
//# sourceMappingURL=main.min.js.map