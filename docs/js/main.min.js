/**
 * @license rxcomp-form v1.0.0-alpha.11
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(require("rxcomp"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("main",["rxcomp","rxjs","rxjs/operators"],n):n((t=t||self).rxcomp,t.rxjs,t.rxjs.operators)}(this,(function(t,n,e){"use strict";function i(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}function r(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}var s={Pending:"pending",Valid:"valid",Invalid:"invalid",Disabled:"disabled"},u=["untouched","touched","pristine","dirty","pending","enabled","disabled","valid","invalid","submitted"],h=function(n){function e(){return n.apply(this,arguments)||this}return r(e,n),e.prototype.onChanges=function(n){var e=t.getContext(this).node,i=this.control;u.forEach((function(t){i[t]?e.classList.add(t):e.classList.remove(t)}))},o(e,[{key:"control",get:function(){return{}}}]),e}(t.Directive);h.meta={hosts:{host:h}};var a=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),o(n,[{key:"control",get:function(){if(this.formArray)return this.formArray;if(!this.host)throw"missing form collection";return this.host.control.get(this.formArrayName)}}]),n}(h);a.meta={selector:"[formArray],[formArrayName]",inputs:["formArray","formArrayName"],hosts:{host:h}};var l=function(n){function e(){return n.apply(this,arguments)||this}r(e,n);var i=e.prototype;return i.onInit=function(){var n=t.getContext(this).node;this.node=n,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),n.addEventListener("input",this.onChange),n.addEventListener("change",this.onChange),n.addEventListener("blur",this.onBlur)},i.onChanges=function(n){var e=t.getContext(this).node,i=this.control;u.forEach((function(t){i[t]?e.classList.add(t):e.classList.remove(t)})),this.writeValue(i.value)},i.writeValue=function(n){t.getContext(this).node.value=null==n?"":n},i.onChange=function(n){var e=t.getContext(this).node;this.control.value=""===e.value?null:e.value},i.onBlur=function(t){this.control.touched=!0},i.setDisabledState=function(n){t.getContext(this).node.disabled=n},o(e,[{key:"control",get:function(){if(this.formControl)return this.formControl;if(!this.host)throw"missing form collection";return this.host.control.get(this.formControlName)}}]),e}(t.Directive);l.meta={inputs:["formControl","formControlName","value"],hosts:{host:h}};var c=function(n){function e(){return n.apply(this,arguments)||this}r(e,n);var i=e.prototype;return i.onInit=function(){var n=t.getContext(this).node;this.node=n,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),n.addEventListener("input",this.onChange),n.addEventListener("blur",this.onBlur)},i.writeValue=function(n){var e=t.getContext(this).node;n===this.value?e.setAttribute("checked",n):e.removeAttribute("checked")},i.setDisabledState=function(n){t.getContext(this).node.disabled=n},i.onChange=function(n){var e=t.getContext(this).node;this.control.value=e.checked?this.value:!0!==this.value&&null},i.onBlur=function(t){this.control.touched=!0},e}(l);c.meta={selector:"input[type=checkbox][formControl],input[type=checkbox][formControlName]",inputs:["formControl","formControlName","value"],hosts:{host:h}};var f=function(n){function e(){return n.apply(this,arguments)||this}return r(e,n),e.prototype.onChanges=function(n){var e=t.getContext(this).node,i=this.control;u.forEach((function(t){i[t]?e.classList.add(t):e.classList.remove(t)}))},o(e,[{key:"control",get:function(){if(this.formField)return this.formField;if(!this.host)throw"missing form collection";return this.host.control.get(this.formFieldName)}}]),e}(t.Component);f.meta={selector:"[formField],[formFieldName]",inputs:["formField","formFieldName"],hosts:{host:h}};var d=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),o(n,[{key:"control",get:function(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control.get(this.formGroupName)}}]),n}(h);d.meta={selector:"[formGroup],[formGroupName]",inputs:["formGroup","formGroupName"],hosts:{host:h}};var p=function(n){function e(){return n.apply(this,arguments)||this}r(e,n);var i=e.prototype;return i.writeValue=function(n){t.getContext(this).node.value=null==n?"":n},i.onChange=function(n){var e=t.getContext(this).node;this.control.value=""===e.value?null:e.value},i.onBlur=function(t){this.control.touched=!0},e}(l);function v(t){return null==t||0===t.length?{required:!0}:null}function m(t){return function(n){if(!n||!t)return null;var e=n?n.length:0;return e<t?{minlength:{requiredLength:t,actualLength:e}}:null}}p.meta={selector:"input[type=text][formControl],input[type=text][formControlName],input[type=email][formControl],input[type=email][formControlName],input[type=password][formControl],input[type=password][formControlName],textarea[formControl],textarea[formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var g=function(t){function n(){return t.apply(this,arguments)||this}r(n,t);var e=n.prototype;return e.onInit=function(){console.log("FormMinLengthDirective",this.host.control,this.minlength);this.validator=m(this.minlength);this.host.control.validators.push(this.validator)},e.onChanges=function(t){var n=m(this.minlength);this.host.control.validators.push(this.validator);var e=this.host.control.validators.indexOf(this.validator);-1!==e?this.host.control.validators.splice(e,1,n):this.host.control.validators.push(n),this.validator=n},n}(t.Directive);g.meta={selector:"[minlength][formControl],[minlength][formControlName]",inputs:["minlength"],hosts:{host:l}};var y=function(n){function e(){return n.apply(this,arguments)||this}return r(e,n),e.prototype.onChanges=function(n){t.getContext(this).node.placeholder=this.placeholder},e}(t.Directive);y.meta={selector:"input[placeholder],textarea[placeholder]",inputs:["placeholder"]};var b=function(n){function e(){return n.apply(this,arguments)||this}r(e,n);var i=e.prototype;return i.onInit=function(){var n=t.getContext(this).node;this.node=n,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),n.addEventListener("input",this.onChange),n.addEventListener("blur",this.onBlur)},i.writeValue=function(n){var e=t.getContext(this).node;e.checked=e.value===n},i.setDisabledState=function(n){t.getContext(this).node.disabled=n},i.onChange=function(n){var e=t.getContext(this).node;e.checked&&(this.control.value=e.value)},i.onBlur=function(t){this.control.touched=!0},e}(l);b.meta={selector:"input[type=radio][formControl],input[type=radio][formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var C=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),n.prototype.onInit=function(){console.log("FormRequiredDirective",this.host.control),this.host.control.validators.push(v)},n}(t.Directive);C.meta={selector:"[required][formControl],[required][formControlName]",inputs:["required"],hosts:{host:l}};var _=function(n){function e(){return n.apply(this,arguments)||this}r(e,n);var i=e.prototype;return i.writeValue=function(n){t.getContext(this).node.value=null==n?"":n},i.setDisabledState=function(n){t.getContext(this).node.disabled=n},i.onChange=function(n){var e=t.getContext(this).node;this.control.value=""===e.value?null:e.value},i.onBlur=function(t){this.control.touched=!0},e}(l);_.meta={selector:"select[formControl],select[formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var x=function(i){function o(){return i.apply(this,arguments)||this}return r(o,i),o.prototype.onInit=function(){var i=t.getContext(this),o=i.module,r=i.node,s=i.selector,u=i.parentInstance,h=this.event=s.replace(/\[|\]|\(|\)/g,""),a=this.event$=n.fromEvent(r,h).pipe(e.tap((function(t){t.preventDefault()})),e.shareReplay(1)),l=r.getAttribute("("+h+")");if(l){var c=o.makeFunction(l,["$event"]);a.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){o.resolve(c,u,t)}))}else u[h+"$"]=a},o}(t.Directive);x.meta={selector:"[(submit)]"};var j=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),n}(t.Module),k=[a,c,f,p,g,b,_,d,y,C,x],S=[];j.meta={declarations:[].concat(k,S),exports:[].concat(k,S)};var w=function(){function t(t){void 0===t&&(t=[]),this.status=s.Pending,this.validators=t,this.errors=[]}var i=t.prototype;return i.initSubjects_=function(){this.valueSubject=new n.BehaviorSubject(null),this.valueChildren=new n.Subject,this.statusSubject=new n.BehaviorSubject(this),this.statusChildren=new n.Subject},i.initObservables_=function(){var t=this;this.value$=n.merge(this.valueSubject,this.valueChildren).pipe(e.distinctUntilChanged(),e.skip(1),e.tap((function(){t.submitted_=!1,t.dirty_=!0,t.statusSubject.next(t)})),e.shareReplay(1)),this.status$=n.merge(this.statusSubject,this.statusChildren).pipe(e.tap((function(){t.reduceValidators_()})),e.shareReplay(1)),this.changes$=n.merge(this.value$,this.status$).pipe(e.map((function(){return t.value})),e.shareReplay(1))},i.reduceValidators_=function(){return this.validate(this.value)},i.validate=function(t){return this.status===s.Disabled||this.submitted_?this.errors={}:(this.errors=Object.assign.apply(Object,[{}].concat(this.validators.map((function(n){return n(t)})))),this.status=0===Object.keys(this.errors).length?s.Valid:s.Invalid),this.errors},i.reset=function(){this.status=s.Pending,this.value_=null,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(this)},i.patch=function(t){this.value_=t,this.dirty_=!0,this.submitted_=!1,this.statusSubject.next(this)},o(t,[{key:"pending",get:function(){return this.status===s.Pending}},{key:"valid",get:function(){return this.status===s.Valid}},{key:"invalid",get:function(){return this.status===s.Invalid}},{key:"disabled",get:function(){return this.status===s.Disabled},set:function(t){t?this.status=s.Disabled:this.reduceValidators_(),this.statusSubject.next(this)}},{key:"enabled",get:function(){return this.status!==s.Disabled}},{key:"submitted",get:function(){return this.submitted_},set:function(t){this.submitted_=t,this.statusSubject.next(this)}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(t){this.touched_=t,this.statusSubject.next(this)}},{key:"untouched",get:function(){return!this.touched_}},{key:"value",get:function(){return this.value_},set:function(t){this.value_=t,this.valueSubject.next(t)}}]),t}(),N=function(t){function n(n,e){var i;return void 0===n&&(n=null),(i=t.call(this,e)||this).value_=n,i.initSubjects_(),i.initObservables_(),i.statusSubject.next(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}return r(n,t),n}(w),E=function(t){function i(n,e){var i;return(i=t.call(this,e)||this).controls=n,i.initControls_(n),i.initSubjects_(),i.initObservables_(),i}r(i,t);var u=i.prototype;return u.initControl_=function(t){return t instanceof w?t:new N(t,this.validators)},u.initControls_=function(t){var n=this;return this.forEach_((function(t,e){n.init(t,e)})),t},u.initSubjects_=function(){this.changesChildren=(new n.BehaviorSubject).pipe(e.switchAll()),this.switchSubjects_()},u.switchSubjects_=function(){var t=this.reduce_((function(t,n){return t.push(n.changes$),t}),[]),e=t.length?n.combineLatest(t):n.of(t);this.changesChildren.next(e)},u.initObservables_=function(){var t=this;this.changes$=this.changesChildren.pipe(e.map((function(){return t.value})),e.shareReplay(1))},u.validate=function(t){if(this.status===s.Disabled)this.errors=[];else{var n=this.validators.map((function(n){return n(t)})).filter((function(t){return null!==t}));this.errors=this.reduce_((function(t,n){return t.concat(n.errors)}),n),this.status=0===this.errors.length?s.Valid:s.Invalid}return this.errors},u.forEach_=function(t){var n=this;Object.keys(this.controls).forEach((function(e){return t(n.controls[e],e)}))},u.reduce_=function(t,n){return this.forEach_((function(e,i){n=t(n,e,i)})),n},u.all_=function(t,n){return this.reduce_((function(e,i){return e&&i[t]===n}),!0)},u.any_=function(t,n){return this.reduce_((function(e,i){return e||i[t]===n}),!1)},u.reset=function(){this.forEach_((function(t){return t.reset()}))},u.patch=function(t){t&&this.forEach_((function(n,e){n.patch(t[e])}))},u.init=function(t,n){this.controls[n]=this.initControl_(t)},u.get=function(t){return this.controls[t]},u.set=function(t,n){delete this.controls[n],this.controls[n]=this.initControl_(t),this.switchSubjects_()},u.add=function(t,n){this.controls[n]=this.initControl_(t),this.switchSubjects_()},u.remove=function(t){var n=this,e=Object.keys(this.controls).find((function(e){return n.controls[e]===t?e:null}));e&&this.removeKey(e)},u.removeKey=function(t){var n=void 0!==this.controls[t];delete this.controls[t],n&&this.switchSubjects_()},o(i,[{key:"valid",get:function(){return this.all_("valid",!0)}},{key:"invalid",get:function(){return this.any_("invalid",!0)}},{key:"pending",get:function(){return this.any_("pending",!0)}},{key:"disabled",get:function(){return this.all_("disabled",!0)},set:function(t){this.forEach_((function(n){n.disabled=t}))}},{key:"enabled",get:function(){return this.any_("enabled",!0)}},{key:"submitted",get:function(){return this.all_("submitted",!0)},set:function(t){this.forEach_((function(n){n.submitted=t}))}},{key:"dirty",get:function(){return this.any_("dirty",!0)}},{key:"pristine",get:function(){return this.all_("pristine",!0)}},{key:"touched",get:function(){return this.all_("touched",!0)},set:function(t){this.forEach_((function(n){n.touched=t}))}},{key:"untouched",get:function(){return this.any_("untouched",!0)}},{key:"value",get:function(){return this.reduce_((function(t,n,e){return t[e]=n.value,t}),{})},set:function(t){this.forEach_((function(n,e){n.value=t[e]}))}}]),i}(w),D=function(t){function n(n,e){return void 0===n&&(n=[]),t.call(this,n,e)||this}r(n,t);var e=n.prototype;return e.forEach_=function(t){this.controls.forEach((function(n,e){return t(n,e)}))},e.init=function(t,n){this.controls.length=Math.max(this.controls.length,n),this.controls[n]=this.initControl_(t)},e.set=function(t,n){this.controls.splice(n,1,this.initControl_(t)),this.switchSubjects_()},e.add=function(t,n){this.controls.length=Math.max(this.controls.length,n),this.controls[n]=this.initControl_(t),this.switchSubjects_()},e.push=function(t){this.controls.push(this.initControl_(t)),this.switchSubjects_()},e.insert=function(t,n){this.controls.splice(n,0,this.initControl_(t)),this.switchSubjects_()},e.remove=function(t){var n=this.controls.indexOf(t);-1!==n&&this.removeKey(n)},e.removeKey=function(t){this.controls.length>t&&(this.controls.splice(t,1),this.switchSubjects_())},e.at=function(t){return this.controls[t]},o(n,[{key:"value",get:function(){return this.reduce_((function(t,n,e){return t[e]=n.value,t}),[])}},{key:"length",get:function(){return this.controls.length}}]),n}(E),B=function(t){function n(n,e){return void 0===n&&(n={}),t.call(this,n,e)||this}return r(n,t),n}(E),L=function(t){function n(){return t.apply(this,arguments)||this}r(n,t);var e=n.prototype;return e.onInit=function(){var t=this,n=new B({firstName:null,lastName:null,email:null,country:null,evaluate:null,privacy:null,items:new D([null,null,null],[v])},[v]);n.patch({firstName:"Jhon",lastName:"Appleseed",email:"jhonappleseed@gmail.com",country:"en-US"}),n.changes$.subscribe((function(e){console.log("AppComponent.form.changes$",e,n.valid),t.pushChanges()})),this.form=n},e.onValidate=function(){return this.form.valid},e.onSubmit=function(){this.form.valid&&(console.log("AppComponent.onSubmit",this.form.value),this.form.submitted=!0)},n}(t.Component);L.meta={selector:"[app-component]"};var A=function(t){function n(){return t.apply(this,arguments)||this}return r(n,t),n}(t.Module);A.meta={imports:[t.CoreModule,j],declarations:[],bootstrap:L},t.Browser.bootstrap(A)}));
//# sourceMappingURL=main.min.js.map