/**
 * @license rxcomp-form v1.0.0-alpha.6
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define("main",["rxcomp","rxjs/operators","rxjs"],e):e((t=t||self).rxcomp,t.rxjs.operators,t.rxjs)}(this,(function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var u="valid",s="invalid",a="pending",c="disabled",h=["untouched","touched","pristine","dirty","pending","enabled","disabled","valid","invalid"],f=function(n){function r(){return n.apply(this,arguments)||this}o(r,n);var i=r.prototype;return i.getFormRef=function(t){return this.controlGroupName?t.get(this.controlGroupName):this.controlGroup},i.onChanges=function(n){var r=t.getContext(this).node,i=this.getFormRef(n.formRef);this.formRef=i,i.status$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){h.forEach((function(t){i[t]?r.classList.add(t):r.classList.remove(t)}))}))},r}(t.Directive);f.meta={selector:"[[controlGroup]],[[controlGroupName]],[controlGroupName]",inputs:["controlGroup","controlGroupName"]};var l=function(n){function r(){return n.apply(this,arguments)||this}o(r,n);var i=r.prototype;return i.getFormRef=function(t){return this.formControlName?t.get(this.formControlName):this.formControl},i.onInit=function(){var e=t.getContext(this).node;this.node=e,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),e.addEventListener("input",this.onChange),e.addEventListener("change",this.onChange),e.addEventListener("blur",this.onBlur)},i.onChanges=function(n){var r=t.getContext(this).node,i=this.getFormRef(n.formRef);this.formRef=i,i.value$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){})),i.status$.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){h.forEach((function(t){i[t]?r.classList.add(t):r.classList.remove(t)}))})),this.writeValue(i.value)},i.writeValue=function(e){t.getContext(this).node.setAttribute("value",null==e?"":e)},i.setDisabledState=function(e){t.getContext(this).node.setAttribute("disabled",e)},i.onChange=function(e){var n=t.getContext(this).node;this.formRef.value=n.value},i.onFocus=function(t){},i.onBlur=function(t){this.formRef.touched=!0},i.getPre=function(t){var e=t.previousSibling;return e&&3===e.nodeType||(e=document.createTextNode(""),t.parentNode.insertBefore(e,t)),e},r}(t.Directive);l.meta={selector:"input,textarea,select",inputs:["formControl","formControlName"]};var p=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.getFormRef=function(t){return this.formGroupName?t.get(this.formGroupName):this.formGroup},n.onChanges=function(t){var e=this.getFormRef(t.formRef);this.formRef=e},e}(t.Component);p.meta={selector:"[[formGroup]],[[formGroupName]],[formGroupName]",inputs:["formGroup","formGroupName"]};var d=function(r){function i(){return r.apply(this,arguments)||this}return o(i,r),i.prototype.onInit=function(){var r=t.getContext(this),i=r.module,o=r.node,u=r.selector,s=r.parentInstance,a=this.event=u.replace(/\[|\]|\(|\)/g,""),c=this.event$=n.fromEvent(o,a).pipe(e.tap((function(t){t.preventDefault()})),e.shareReplay(1)),h=o.getAttribute("("+a+")");if(h){var f=i.makeFunction(h,["$event"]);c.pipe(e.takeUntil(this.unsubscribe$)).subscribe((function(t){i.resolve(f,s,t)}))}else s[a+"$"]=c},i}(t.Directive);d.meta={selector:"[("+["submit"].join(")],[(")+")]"};var v=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(t.Module),b=[l,p,f,d],m=[];v.meta={declarations:[].concat(b,m),exports:[].concat(b,m)};var g=function(){function t(t){void 0===t&&(t=[]),this.validators=t,this.errors=[]}var r=t.prototype;return r.initSubjects_=function(){this.valueSubject=new n.BehaviorSubject(null),this.valueChildren=new n.Subject,this.statusSubject=new n.BehaviorSubject(this),this.statusChildren=new n.Subject},r.initObservables_=function(){var t=this;this.value$=n.merge(this.valueSubject,this.valueChildren).pipe(e.distinctUntilChanged(),e.skip(1),e.tap((function(e){t.dirty_=!0,e===t.value&&t.statusSubject.next(t)})),e.shareReplay(1)),this.status$=n.merge(this.statusSubject,this.statusChildren).pipe(e.tap((function(e){t.reduceValidators_()})),e.shareReplay(1))},r.reduceValidators_=function(){return[]},r.validate=function(t){return this.status===c?this.errors=[]:(this.errors=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t})),this.status=0===this.errors.length?u:s),this.errors},i(t,[{key:"valid",get:function(){return this.status===u}},{key:"invalid",get:function(){return this.status===s}},{key:"pending",get:function(){return this.status===a}},{key:"disabled",get:function(){return this.status===c}},{key:"enabled",get:function(){return this.status!==c}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(t){this.touched_=t,this.statusSubject.next(this)}},{key:"untouched",get:function(){return!this.touched_}},{key:"value",get:function(){return this.value_},set:function(t){this.value_=t,this.valueSubject.next(t)}}]),t}(),y=function(t){function e(e,n){var r;return void 0===e&&(e=null),(r=t.call(this,n)||this).value_=e,r.initSubjects_(),r.initObservables_(),r.statusSubject.next(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}return o(e,t),e.prototype.reduceValidators_=function(){return this.validate(this.value)},e}(g),_=function(t){function e(e,n){return void 0===e&&(e={}),t.call(this,e,n)||this}o(e,t);var n=e.prototype;return n.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},n.get=function(t){return this.controls[t]},n.set=function(t,e){this.controls[e]=t},e}(function(t){function r(e,n){var r;return(r=t.call(this,n)||this).controls=e,r.initControls_(e),r.initSubjects_(),r.initObservables_(),r}o(r,t);var a=r.prototype;return a.initControl_=function(t){return t instanceof g?t:new y(t,this.validators)},a.initControls_=function(t){var e=this;return this.forEach_((function(t,n){e.set(e.initControl_(t),n)})),t},a.initSubjects_=function(){var t=this;this.valueSubject=new n.BehaviorSubject(null);var r=this.reduce_((function(t,e){return t.push(e.valueSubject),t}),[]);this.valueChildren=n.combineLatest(r).pipe(e.map((function(e){return t.value})),e.shareReplay(1)),this.statusSubject=new n.BehaviorSubject(this);var i=this.reduce_((function(t,e){return t.push(e.status$),t}),[]);this.statusChildren=n.combineLatest(i).pipe(e.shareReplay(1))},a.validate=function(t){if(this.status===c)this.errors=[];else{var e=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t}));e=this.reduce_((function(t,e){return t.concat(e.errors)}),e),this.status=0===this.errors.length?u:s}return this.errors},a.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},a.reduce_=function(t,e){return this.forEach_((function(n,r){e=t(e,n,r)})),e},a.all_=function(t,e){return this.reduce_((function(n,r){return n&&r[t]===e}),!0)},a.any_=function(t,e){return this.reduce_((function(n,r){return n||r[t]===e}),!1)},a.get=function(t){return this.controls[t]},a.set=function(t,e){this.controls[e]=t},i(r,[{key:"touched",get:function(){return this.reduce_((function(t,e){return t&&e.touched}),!0)},set:function(t){this.forEach_((function(e){e.touched=t})),this.statusSubject.next(this)}},{key:"value",get:function(){return this.reduce_((function(t,e,n){return t[n]=e.value,t}),{})},set:function(t){}}]),r}(g));function C(t){return null==t||0===t.length?"required":null}var j=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.onInit=function(){var t=this.form=new _({firstName:"Jhon",lastName:"Appleseed"},[C]);t.value$.subscribe((function(t){})),t.status$.subscribe((function(){}))},n.onValidate=function(){return this.form.valid},n.onSubmit=function(){},e}(t.Component);j.meta={selector:"[app-component]"};var x=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e}(t.Module);x.meta={imports:[t.CoreModule,v],bootstrap:j},t.Module.prototype.makeInputs=function(t,e){var n=this,r={};return t.inputs&&t.inputs.forEach((function(t,i){var o=n.makeInput(e,t);o&&(r[t]=o)})),r},t.Module.prototype.makeInput=function(e,n){var r,i=t.getContext(e).node,o=null;return i.hasAttribute(n)?o="'"+i.getAttribute(n)+"'":i.hasAttribute("["+n+"]")&&(o=i.getAttribute("["+n+"]")),null!==o&&(r=this.makeFunction(o)),r},t.Module.prototype.getInstance=function(e){if(e===document)return window;var n=t.getContextByNode(e);return n?n.instance:void 0},t.Module.prototype.getParentInstance=function(e){var n=this;return t.Module.traverseUp(e,(function(t){return n.getInstance(t)}))},t.Browser.bootstrap(x)}));
//# sourceMappingURL=main.min.js.map