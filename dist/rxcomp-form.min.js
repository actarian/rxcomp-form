/**
 * @license rxcomp-form v1.0.0-alpha.11
 * (c) 2019 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxcomp"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("rxcomp-form",["exports","rxcomp","rxjs","rxjs/operators"],e):e((t=t||self)["rxcomp-form"]={},t.rxcomp,t.rxjs,t.rxjs.operators)}(this,(function(t,e,n,i){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var u={Pending:"pending",Valid:"valid",Invalid:"invalid",Disabled:"disabled"},c=["untouched","touched","pristine","dirty","pending","enabled","disabled","valid","invalid","submitted"],h=function(t){function n(){return t.apply(this,arguments)||this}return s(n,t),n.prototype.onChanges=function(t){var n=e.getContext(this).node,i=this.control;c.forEach((function(t){i[t]?n.classList.add(t):n.classList.remove(t)}))},r(n,[{key:"control",get:function(){return{}}}]),n}(e.Directive);h.meta={hosts:{host:h}};var a=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),r(e,[{key:"control",get:function(){if(this.formArray)return this.formArray;if(!this.host)throw"missing form collection";return this.host.control.get(this.formArrayName)}}]),e}(h);a.meta={selector:"[formArray],[formArrayName]",inputs:["formArray","formArrayName"],hosts:{host:h}};var l=function(t){function n(){return t.apply(this,arguments)||this}s(n,t);var i=n.prototype;return i.onInit=function(){var t=e.getContext(this).node;this.node=t,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),t.addEventListener("input",this.onChange),t.addEventListener("change",this.onChange),t.addEventListener("blur",this.onBlur)},i.onChanges=function(t){var n=e.getContext(this).node,i=this.control;c.forEach((function(t){i[t]?n.classList.add(t):n.classList.remove(t)})),this.writeValue(i.value)},i.writeValue=function(t){e.getContext(this).node.value=null==t?"":t},i.onChange=function(t){var n=e.getContext(this).node;this.control.value=""===n.value?null:n.value},i.onBlur=function(t){this.control.touched=!0},i.setDisabledState=function(t){e.getContext(this).node.disabled=t},r(n,[{key:"control",get:function(){if(this.formControl)return this.formControl;if(!this.host)throw"missing form collection";return this.host.control.get(this.formControlName)}}]),n}(e.Directive);l.meta={inputs:["formControl","formControlName","value"],hosts:{host:h}};var f=function(t){function n(){return t.apply(this,arguments)||this}s(n,t);var i=n.prototype;return i.onInit=function(){var t=e.getContext(this).node;this.node=t,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),t.addEventListener("input",this.onChange),t.addEventListener("blur",this.onBlur)},i.writeValue=function(t){var n=e.getContext(this).node;t===this.value?n.setAttribute("checked",t):n.removeAttribute("checked")},i.setDisabledState=function(t){e.getContext(this).node.disabled=t},i.onChange=function(t){var n=e.getContext(this).node;this.control.value=n.checked?this.value:!0!==this.value&&null},i.onBlur=function(t){this.control.touched=!0},n}(l);f.meta={selector:"input[type=checkbox][formControl],input[type=checkbox][formControlName]",inputs:["formControl","formControlName","value"],hosts:{host:h}};var d=function(t){function n(){return t.apply(this,arguments)||this}return s(n,t),n.prototype.onChanges=function(t){var n=e.getContext(this).node,i=this.control;c.forEach((function(t){i[t]?n.classList.add(t):n.classList.remove(t)}))},r(n,[{key:"control",get:function(){if(this.formField)return this.formField;if(!this.host)throw"missing form collection";return this.host.control.get(this.formFieldName)}}]),n}(e.Component);d.meta={selector:"[formField],[formFieldName]",inputs:["formField","formFieldName"],hosts:{host:h}};var p=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),r(e,[{key:"control",get:function(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control.get(this.formGroupName)}}]),e}(h);p.meta={selector:"[formGroup],[formGroupName]",inputs:["formGroup","formGroupName"],hosts:{host:h}};var v=function(t){function n(){return t.apply(this,arguments)||this}s(n,t);var i=n.prototype;return i.writeValue=function(t){e.getContext(this).node.value=null==t?"":t},i.onChange=function(t){var n=e.getContext(this).node;this.control.value=""===n.value?null:n.value},i.onBlur=function(t){this.control.touched=!0},n}(l);v.meta={selector:"input[type=text][formControl],input[type=text][formControlName],input[type=email][formControl],input[type=email][formControlName],input[type=password][formControl],input[type=password][formControlName],textarea[formControl],textarea[formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var m=function(t){function n(){return t.apply(this,arguments)||this}return s(n,t),n.prototype.onChanges=function(t){e.getContext(this).node.placeholder=this.placeholder},n}(e.Directive);m.meta={selector:"input[placeholder],textarea[placeholder]",inputs:["placeholder"]};var g=function(t){function n(){return t.apply(this,arguments)||this}s(n,t);var i=n.prototype;return i.onInit=function(){var t=e.getContext(this).node;this.node=t,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),t.addEventListener("input",this.onChange),t.addEventListener("blur",this.onBlur)},i.writeValue=function(t){var n=e.getContext(this).node;n.checked=n.value===t},i.setDisabledState=function(t){e.getContext(this).node.disabled=t},i.onChange=function(t){var n=e.getContext(this).node;n.checked&&(this.control.value=n.value)},i.onBlur=function(t){this.control.touched=!0},n}(l);g.meta={selector:"input[type=radio][formControl],input[type=radio][formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var b=function(t){function n(){return t.apply(this,arguments)||this}s(n,t);var i=n.prototype;return i.writeValue=function(t){e.getContext(this).node.value=null==t?"":t},i.setDisabledState=function(t){e.getContext(this).node.disabled=t},i.onChange=function(t){var n=e.getContext(this).node;this.control.value=""===n.value?null:n.value},i.onBlur=function(t){this.control.touched=!0},n}(l);b.meta={selector:"select[formControl],select[formControlName]",inputs:["formControl","formControlName"],hosts:{host:h}};var y=function(t){function o(){return t.apply(this,arguments)||this}return s(o,t),o.prototype.onInit=function(){var t=e.getContext(this),o=t.module,r=t.node,s=t.selector,u=t.parentInstance,c=this.event=s.replace(/\[|\]|\(|\)/g,""),h=this.event$=n.fromEvent(r,c).pipe(i.tap((function(t){t.preventDefault()})),i.shareReplay(1)),a=r.getAttribute("("+c+")");if(a){var l=o.makeFunction(a,["$event"]);h.pipe(i.takeUntil(this.unsubscribe$)).subscribe((function(t){o.resolve(l,u,t)}))}else u[c+"$"]=h},o}(e.Directive);y.meta={selector:"[(submit)]"};var C=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e}(e.Module),_=[a,f,d,v,g,b,p,m,y],x=[];C.meta={declarations:[].concat(_,x),exports:[].concat(_,x)};var j=function(){function t(t){void 0===t&&(t=[]),this.status=u.Pending,this.validators=t,this.errors=[]}var e=t.prototype;return e.initSubjects_=function(){this.valueSubject=new n.BehaviorSubject(null),this.valueChildren=new n.Subject,this.statusSubject=new n.BehaviorSubject(this),this.statusChildren=new n.Subject},e.initObservables_=function(){var t=this;this.value$=n.merge(this.valueSubject,this.valueChildren).pipe(i.distinctUntilChanged(),i.skip(1),i.tap((function(){t.submitted_=!1,t.dirty_=!0,t.statusSubject.next(t)})),i.shareReplay(1)),this.status$=n.merge(this.statusSubject,this.statusChildren).pipe(i.tap((function(){t.reduceValidators_()})),i.shareReplay(1)),this.changes$=n.merge(this.value$,this.status$).pipe(i.map((function(){return t.value})),i.shareReplay(1))},e.reduceValidators_=function(){return this.validate(this.value)},e.validate=function(t){return this.status===u.Disabled||this.submitted_?this.errors={}:(this.errors=Object.assign.apply(Object,[{}].concat(this.validators.map((function(e){return e(t)})))),this.status=0===Object.keys(this.errors).length?u.Valid:u.Invalid),this.errors},e.reset=function(){this.status=u.Pending,this.value_=null,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(this)},e.patch=function(t){this.value_=t,this.dirty_=!0,this.submitted_=!1,this.statusSubject.next(this)},r(t,[{key:"pending",get:function(){return this.status===u.Pending}},{key:"valid",get:function(){return this.status===u.Valid}},{key:"invalid",get:function(){return this.status===u.Invalid}},{key:"disabled",get:function(){return this.status===u.Disabled},set:function(t){t?this.status=u.Disabled:this.reduceValidators_(),this.statusSubject.next(this)}},{key:"enabled",get:function(){return this.status!==u.Disabled}},{key:"submitted",get:function(){return this.submitted_},set:function(t){this.submitted_=t,this.statusSubject.next(this)}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(t){this.touched_=t,this.statusSubject.next(this)}},{key:"untouched",get:function(){return!this.touched_}},{key:"value",get:function(){return this.value_},set:function(t){this.value_=t,this.valueSubject.next(t)}}]),t}(),k=function(t){function e(e,n){var i;return void 0===e&&(e=null),(i=t.call(this,n)||this).value_=e,i.initSubjects_(),i.initObservables_(),i.statusSubject.next(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}return s(e,t),e}(j),S=function(t){function e(e,n){var i;return(i=t.call(this,n)||this).controls=e,i.initControls_(e),i.initSubjects_(),i.initObservables_(),i}s(e,t);var o=e.prototype;return o.initControl_=function(t){return t instanceof j?t:new k(t,this.validators)},o.initControls_=function(t){var e=this;return this.forEach_((function(t,n){e.init(t,n)})),t},o.initSubjects_=function(){this.changesChildren=(new n.BehaviorSubject).pipe(i.switchAll()),this.switchSubjects_()},o.switchSubjects_=function(){var t=this.reduce_((function(t,e){return t.push(e.changes$),t}),[]),e=t.length?n.combineLatest(t):n.of(t);this.changesChildren.next(e)},o.initObservables_=function(){var t=this;this.changes$=this.changesChildren.pipe(i.map((function(){return t.value})),i.shareReplay(1))},o.validate=function(t){if(this.status===u.Disabled)this.errors=[];else{var e=this.validators.map((function(e){return e(t)})).filter((function(t){return null!==t}));this.errors=this.reduce_((function(t,e){return t.concat(e.errors)}),e),this.status=0===this.errors.length?u.Valid:u.Invalid}return this.errors},o.forEach_=function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))},o.reduce_=function(t,e){return this.forEach_((function(n,i){e=t(e,n,i)})),e},o.all_=function(t,e){return this.reduce_((function(n,i){return n&&i[t]===e}),!0)},o.any_=function(t,e){return this.reduce_((function(n,i){return n||i[t]===e}),!1)},o.reset=function(){this.forEach_((function(t){return t.reset()}))},o.patch=function(t){t&&this.forEach_((function(e,n){e.patch(t[n])}))},o.init=function(t,e){this.controls[e]=this.initControl_(t)},o.get=function(t){return this.controls[t]},o.set=function(t,e){delete this.controls[e],this.controls[e]=this.initControl_(t),this.switchSubjects_()},o.add=function(t,e){this.controls[e]=this.initControl_(t),this.switchSubjects_()},o.remove=function(t){var e=this,n=Object.keys(this.controls).find((function(n){return e.controls[n]===t?n:null}));n&&this.removeKey(n)},o.removeKey=function(t){var e=void 0!==this.controls[t];delete this.controls[t],e&&this.switchSubjects_()},r(e,[{key:"valid",get:function(){return this.all_("valid",!0)}},{key:"invalid",get:function(){return this.any_("invalid",!0)}},{key:"pending",get:function(){return this.any_("pending",!0)}},{key:"disabled",get:function(){return this.all_("disabled",!0)},set:function(t){this.forEach_((function(e){e.disabled=t}))}},{key:"enabled",get:function(){return this.any_("enabled",!0)}},{key:"submitted",get:function(){return this.all_("submitted",!0)},set:function(t){this.forEach_((function(e){e.submitted=t}))}},{key:"dirty",get:function(){return this.any_("dirty",!0)}},{key:"pristine",get:function(){return this.all_("pristine",!0)}},{key:"touched",get:function(){return this.all_("touched",!0)},set:function(t){this.forEach_((function(e){e.touched=t}))}},{key:"untouched",get:function(){return this.any_("untouched",!0)}},{key:"value",get:function(){return this.reduce_((function(t,e,n){return t[n]=e.value,t}),{})},set:function(t){this.forEach_((function(e,n){e.value=t[n]}))}}]),e}(j),w=function(t){function e(e,n){return void 0===e&&(e=[]),t.call(this,e,n)||this}s(e,t);var n=e.prototype;return n.forEach_=function(t){this.controls.forEach((function(e,n){return t(e,n)}))},n.init=function(t,e){this.controls.length=Math.max(this.controls.length,e),this.controls[e]=this.initControl_(t)},n.set=function(t,e){this.controls.splice(e,1,this.initControl_(t)),this.switchSubjects_()},n.add=function(t,e){this.controls.length=Math.max(this.controls.length,e),this.controls[e]=this.initControl_(t),this.switchSubjects_()},n.push=function(t){this.controls.push(this.initControl_(t)),this.switchSubjects_()},n.insert=function(t,e){this.controls.splice(e,0,this.initControl_(t)),this.switchSubjects_()},n.remove=function(t){var e=this.controls.indexOf(t);-1!==e&&this.removeKey(e)},n.removeKey=function(t){this.controls.length>t&&(this.controls.splice(t,1),this.switchSubjects_())},n.at=function(t){return this.controls[t]},r(e,[{key:"value",get:function(){return this.reduce_((function(t,e,n){return t[n]=e.value,t}),[])}},{key:"length",get:function(){return this.controls.length}}]),e}(S);var F=function(t){function e(e,n){return void 0===e&&(e={}),t.call(this,e,n)||this}return s(e,t),e}(S);t.FormAbstract=j,t.FormAbstractCollection=S,t.FormAbstractCollectionDirective=h,t.FormArray=w,t.FormArrayDirective=a,t.FormCheckboxDirective=f,t.FormControl=k,t.FormFieldComponent=d,t.FormGroup=F,t.FormGroupDirective=p,t.FormInputDirective=v,t.FormModule=C,t.FormPlaceholderDirective=m,t.FormRadioDirective=g,t.FormSelectDirective=b,t.FormStatus=u,t.RequiredValidator=function(t){return null==t||0===t.length?{required:!0}:null},t.formArray=function(t,e){return new w(t,e)},t.formGroup=function(t,e){return new F(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=rxcomp-form.min.js.map